#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
èµ¤åœŸå´å…¨é½¡ç¤¾ç¦æ¨ç´ - è²¡å‹™è©¦ç®—è¡¨ç”Ÿæˆå™¨
ç”Ÿæˆæ—¥æœŸ: 2025-10-23
ç›®æ¨™: 114å¹´æ–°ç«¹æ”¿ç­–é»‘å®¢æ¾è²¡å‹™åˆ†æ
"""

import pandas as pd
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill, Alignment, Border, Side
from openpyxl.utils.dataframe import dataframe_to_rows
from datetime import datetime

def create_financial_workbook():
    """å‰µå»ºå®Œæ•´çš„è²¡å‹™è©¦ç®— Excel å·¥ä½œç°¿"""

    wb = Workbook()

    # ç§»é™¤é»˜èªå·¥ä½œè¡¨
    if 'Sheet' in wb.sheetnames:
        wb.remove(wb['Sheet'])

    # ========== å·¥ä½œè¡¨ 1: ç¸½è¦½ (Executive Summary) ==========
    ws1 = wb.create_sheet("1ï¸âƒ£ ç¸½è¦½")

    overview_data = [
        ["èµ¤åœŸå´å…¨é½¡ç¤¾ç¦æ¨ç´ - è²¡å‹™è©¦ç®—è¡¨", ""],
        ["å ±å‘Šæ—¥æœŸ", datetime.now().strftime("%Yå¹´%mæœˆ%dæ—¥")],
        ["å°ˆæ¡ˆä»£è™Ÿ", "114å¹´æ–°ç«¹æ”¿ç­–é»‘å®¢æ¾ææ¡ˆ"],
        ["", ""],
        ["ğŸ“Š é—œéµè²¡å‹™æŒ‡æ¨™", ""],
        ["", ""],
        ["æŒ‡æ¨™é …ç›®", "æ•¸å€¼"],
        ["æœˆåº¦æ·¨æ”¶å…¥", "519,550 å…ƒ"],
        ["å¹´åº¦ç›ˆé¤˜", "6,234,600 å…ƒ"],
        ["ç›ˆé¤˜ç‡", "23.0%"],
        ["SROI æ¯”ç‡", "1 : 2.04"],
        ["å»ºè¨­ç¸½æˆæœ¬", "230,000,000 å…ƒ"],
        ["å“¡å·¥ç¸½æ•¸", "29 äºº"],
        ["æœå‹™å®¹é‡", "140-180 äºº/æ—¥"],
        ["", ""],
        ["ğŸ’° æ”¶æ”¯å¹³è¡¡ç‹€æ…‹", ""],
        ["", ""],
        ["é …ç›®", "æœˆåº¦é‡‘é¡", "å¹´åº¦é‡‘é¡"],
        ["ç¸½æ”¶å…¥", "2,778,600", "33,343,200"],
        ["ç¸½æ”¯å‡º", "2,259,050", "27,108,600"],
        ["æ·¨æ”¶å…¥", "519,550", "6,234,600"],
        ["", ""],
        ["âœ… è²¡å‹™å¥åº·åº¦è©•ä¼°", ""],
        ["", ""],
        ["è©•ä¼°é …ç›®", "ç‹€æ…‹"],
        ["æ”¶æ”¯å¹³è¡¡", "âœ… å„ªè‰¯ (æœˆæ·¨æ”¶å…¥ +51.9è¬å…ƒ)"],
        ["SROI é”æ¨™", "âœ… ç¬¦åˆç¤¾ç¦æ¨™æº– (1.5-2.0)"],
        ["é¢¨éšªæ§åˆ¶", "âœ… 80%æ»¿è¼‰ç‡ä»å¯å¹³è¡¡"],
        ["ä¼æ¥­ESG", "âœ… å¹´åº¦1,050è¬å…ƒè´ŠåŠ©"],
    ]

    for row in overview_data:
        ws1.append(row)

    # è¨­ç½®æ¨™é¡Œæ¨£å¼
    ws1['A1'].font = Font(size=16, bold=True, color="FFFFFF")
    ws1['A1'].fill = PatternFill(start_color="1F4E78", end_color="1F4E78", fill_type="solid")
    ws1.merge_cells('A1:B1')

    # èª¿æ•´åˆ—å¯¬
    ws1.column_dimensions['A'].width = 30
    ws1.column_dimensions['B'].width = 25
    ws1.column_dimensions['C'].width = 25

    # ========== å·¥ä½œè¡¨ 2: äººåŠ›é…ç½® ==========
    ws2 = wb.create_sheet("2ï¸âƒ£ äººåŠ›é…ç½®")

    staffing_headers = ["æ¨“å±¤", "æœå‹™é¡å‹", "è·ä½", "äººæ•¸", "æœˆè–ª (å…ƒ)", "æœˆæˆæœ¬ (å…ƒ)", "å¹´æˆæœ¬ (å…ƒ)"]
    ws2.append(["èµ¤åœŸå´å…¨é½¡ç¤¾ç¦æ¨ç´ - äººåŠ›é…ç½®æ˜ç´°è¡¨ (29åå“¡å·¥)"])
    ws2.append([])
    ws2.append(staffing_headers)

    staffing_data = [
        ["1F", "é•·ç…§æ—¥ç…§ä¸­å¿ƒ", "ç…§æœå“¡", 6, 38000, 228000, 2736000],
        ["1F", "é•·ç…§æ—¥ç…§ä¸­å¿ƒ", "è­·ç†å¸«", 1, 55000, 55000, 660000],
        ["1F", "é•·ç…§æ—¥ç…§ä¸­å¿ƒ", "ç¤¾å·¥å¸«", 1, 45000, 45000, 540000],
        ["2F", "å…¬å…±æ‰˜å¬°ä¸­å¿ƒ", "æ•™ä¿å“¡", 6, 40000, 240000, 2880000],
        ["2F", "å…¬å…±æ‰˜å¬°ä¸­å¿ƒ", "è­·ç†å¸«", 1, 55000, 55000, 660000],
        ["3F", "å®¶åº­æ”¯æŒä¸­å¿ƒ", "è«®å•†å¿ƒç†å¸«", 2, 50000, 100000, 1200000],
        ["3F", "å®¶åº­æ”¯æŒä¸­å¿ƒ", "ç¤¾å·¥å¸«", 1, 45000, 45000, 540000],
        ["3F", "å®¶åº­æ”¯æŒä¸­å¿ƒ", "å»šå¸«", 2, 38000, 76000, 912000],
        ["3F", "å®¶åº­æ”¯æŒä¸­å¿ƒ", "å»šå‹™åŠ©æ‰‹", 2, 30000, 60000, 720000],
        ["4F", "é’å°‘å¹´ä¸­å¿ƒ", "é’å°‘å¹´è¼”å°å“¡", 3, 38000, 114000, 1368000],
        ["4F", "é’å°‘å¹´ä¸­å¿ƒ", "æ´»å‹•è¬›å¸«", 2, 25000, 50000, 600000],
        ["B1/å…¨é¤¨", "è¡Œæ”¿æ”¯æ´", "é¤¨é•·/ä¸»ä»»", 1, 65000, 65000, 780000],
        ["B1/å…¨é¤¨", "è¡Œæ”¿æ”¯æ´", "è¡Œæ”¿äººå“¡", 2, 35000, 70000, 840000],
        ["B1/å…¨é¤¨", "è¡Œæ”¿æ”¯æ´", "è­¦è¡›", 2, 32000, 64000, 768000],
        ["B1/å…¨é¤¨", "è¡Œæ”¿æ”¯æ´", "æ¸…æ½”äººå“¡", 2, 28000, 56000, 672000],
        ["", "", "å°è¨ˆ", 29, "", 1123000, 13476000],
        ["", "", "å‹å¥ä¿ (15%)", "", "", 168450, 2021400],
        ["", "", "å“¡å·¥ç¦åˆ©", "", "", 50000, 600000],
        ["", "", "ç¸½è¨ˆ", 29, "", 1341450, 16097400],
    ]

    for row in staffing_data:
        ws2.append(row)

    # æ ¼å¼åŒ–æ¨™é¡Œ
    ws2.merge_cells('A1:G1')
    ws2['A1'].font = Font(size=14, bold=True, color="FFFFFF")
    ws2['A1'].fill = PatternFill(start_color="4472C4", end_color="4472C4", fill_type="solid")
    ws2['A1'].alignment = Alignment(horizontal="center")

    # è¨­ç½®æ¨™é ­æ¨£å¼
    for col in range(1, 8):
        cell = ws2.cell(row=3, column=col)
        cell.font = Font(bold=True, color="FFFFFF")
        cell.fill = PatternFill(start_color="70AD47", end_color="70AD47", fill_type="solid")
        cell.alignment = Alignment(horizontal="center")

    # èª¿æ•´åˆ—å¯¬
    ws2.column_dimensions['A'].width = 12
    ws2.column_dimensions['B'].width = 20
    ws2.column_dimensions['C'].width = 18
    ws2.column_dimensions['D'].width = 8
    ws2.column_dimensions['E'].width = 15
    ws2.column_dimensions['F'].width = 15
    ws2.column_dimensions['G'].width = 15

    # ========== å·¥ä½œè¡¨ 3: ç‡Ÿé‹æˆæœ¬ ==========
    ws3 = wb.create_sheet("3ï¸âƒ£ ç‡Ÿé‹æˆæœ¬")

    ws3.append(["èµ¤åœŸå´å…¨é½¡ç¤¾ç¦æ¨ç´ - ç‡Ÿé‹æˆæœ¬åˆ†æ"])
    ws3.append([])
    ws3.append(["æˆæœ¬é¡åˆ¥", "æœˆæˆæœ¬ (å…ƒ)", "å¹´æˆæœ¬ (å…ƒ)", "ä½”æ¯”", "èªªæ˜"])

    cost_data = [
        ["äººäº‹è²»ç”¨", 1194050, 14328600, "61.5%", "29åå“¡å·¥è–ªè³‡+å‹å¥ä¿"],
        ["è¨­æ–½è²»ç”¨", 380000, 4560000, "19.6%", "æ°´é›»ã€ç“¦æ–¯ã€ç¶²è·¯ã€æŠ˜èˆŠ"],
        ["æ¥­å‹™è²»ç”¨", 490000, 5880000, "25.2%", "é£Ÿæã€æ•™æã€æ¸…æ½”ã€é†«ç™‚è€—æ"],
        ["ç¶­è­·è²»ç”¨", 125000, 1500000, "6.4%", "è¨­å‚™ç¶­è­·ã€ä¿éšªã€é›œæ”¯"],
        ["ç·©è¡é å‚™é‡‘", 70000, 840000, "3.6%", "ç·Šæ€¥æ”¯å‡ºã€çªç™¼ç‹€æ³"],
        ["ç¸½è¨ˆ", 2259050, 27108600, "116.3%", "ç´„2,711è¬å…ƒ/å¹´"],
    ]

    for row in cost_data:
        ws3.append(row)

    ws3.append([])
    ws3.append(["ğŸ“‹ æˆæœ¬æ˜ç´°èªªæ˜"])
    ws3.append([])
    ws3.append(["é¡åˆ¥", "é …ç›®", "é‡‘é¡ (å…ƒ/æœˆ)"])

    cost_details = [
        ["äººäº‹è²»ç”¨", "åŸºæœ¬è–ªè³‡", "1,123,000"],
        ["", "å‹å¥ä¿ (15%)", "168,450"],
        ["", "å“¡å·¥ç¦åˆ© (åœ˜ä¿ã€åˆ¶æœç­‰)", "50,000"],
        ["", "å°è¨ˆ", "1,341,450"],
        ["è¨­æ–½è²»ç”¨", "æ°´é›»è²»", "150,000"],
        ["", "ç“¦æ–¯è²»", "30,000"],
        ["", "ç¶²è·¯é›»è©±è²»", "20,000"],
        ["", "è¨­å‚™æŠ˜èˆŠ", "180,000"],
        ["", "å°è¨ˆ", "380,000"],
        ["æ¥­å‹™è²»ç”¨", "é£Ÿææˆæœ¬ (é•·ç…§+æ‰˜è‚²+å…±é¤)", "250,000"],
        ["", "æ•™ææ•™å…·", "80,000"],
        ["", "æ¸…æ½”ç”¨å“", "60,000"],
        ["", "é†«ç™‚è€—æ (å£ç½©ã€æ‰‹å¥—ã€æ¶ˆæ¯’)", "100,000"],
        ["", "å°è¨ˆ", "490,000"],
        ["ç¶­è­·è²»ç”¨", "è¨­å‚™ç¶­ä¿®", "50,000"],
        ["", "è²¬ä»»ä¿éšª", "40,000"],
        ["", "é›œæ”¯ (æ–‡å…·ã€å°åˆ·)", "35,000"],
        ["", "å°è¨ˆ", "125,000"],
    ]

    for row in cost_details:
        ws3.append(row)

    # æ ¼å¼åŒ–
    ws3.merge_cells('A1:E1')
    ws3['A1'].font = Font(size=14, bold=True, color="FFFFFF")
    ws3['A1'].fill = PatternFill(start_color="E74C3C", end_color="E74C3C", fill_type="solid")
    ws3['A1'].alignment = Alignment(horizontal="center")

    ws3.column_dimensions['A'].width = 20
    ws3.column_dimensions['B'].width = 30
    ws3.column_dimensions['C'].width = 18
    ws3.column_dimensions['D'].width = 12
    ws3.column_dimensions['E'].width = 35

    # ========== å·¥ä½œè¡¨ 4: æ”¶å…¥ä¾†æº ==========
    ws4 = wb.create_sheet("4ï¸âƒ£ æ”¶å…¥ä¾†æº")

    ws4.append(["èµ¤åœŸå´å…¨é½¡ç¤¾ç¦æ¨ç´ - æ”¶å…¥ä¾†æºåˆ†æ"])
    ws4.append([])
    ws4.append(["æ”¶å…¥ä¾†æº", "æœˆæ”¶å…¥ (å…ƒ)", "å¹´æ”¶å…¥ (å…ƒ)", "ä½”æ¯”", "èªªæ˜"])

    revenue_data = [
        ["é•·ç…§çµ¦ä»˜", 1689600, 20275200, "68.9%", "æ—¥ç…§55äºº + äº¤é€šæ¥é€30äºº"],
        ["æ‰˜è‚²æ”¶è²»", 585000, 7020000, "23.9%", "å…¬æ‰˜45äºº Ã— 13,000å…ƒ/æœˆ"],
        ["é’å°‘å¹´æœå‹™", 74000, 888000, "3.0%", "èª²ç¨‹è²» + æ”¿åºœè£œåŠ©"],
        ["å®¶åº­æ”¯æŒæœå‹™", 210000, 2520000, "8.6%", "è«®å•† + å…±é¤ + æ”¿åºœè£œåŠ©"],
        ["å…¶ä»–æ”¶å…¥", 70000, 840000, "2.9%", "å ´åœ°ç§Ÿå€Ÿ + ææ¬¾"],
        ["ä¼æ¥­ESGè´ŠåŠ©", 150000, 1800000, "6.1%", "å°ç©é›»ã€è¯ç™¼ç§‘åŸºé‡‘æœƒ"],
        ["ç¸½è¨ˆ", 2778600, 33343200, "113.4%", "ç´„3,334è¬å…ƒ/å¹´"],
    ]

    for row in revenue_data:
        ws4.append(row)

    ws4.append([])
    ws4.append(["ğŸ“‹ é•·ç…§çµ¦ä»˜æ˜ç´°"])
    ws4.append([])
    ws4.append(["é …ç›®", "å–®åƒ¹", "ä½¿ç”¨äººæ•¸", "ä½¿ç”¨å¤©æ•¸", "æœˆæ”¶å…¥ (å…ƒ)"])

    ltc_details = [
        ["æ—¥ç…§æœå‹™ (Aç´š)", "1,200å…ƒ/æ—¥", 55, "22å¤©/æœˆ", "1,452,000"],
        ["äº¤é€šæ¥é€æœå‹™", "180å…ƒ/è¶Ÿ (å¾€è¿”360å…ƒ)", 30, "22å¤©/æœˆ", "237,600"],
        ["", "", "", "ç¸½è¨ˆ", "1,689,600"],
    ]

    for row in ltc_details:
        ws4.append(row)

    ws4.append([])
    ws4.append(["ğŸ“‹ æ‰˜è‚²æ”¶è²»æ˜ç´°"])
    ws4.append([])
    ws4.append(["é …ç›®", "é‡‘é¡", "èªªæ˜"])

    childcare_details = [
        ["æ”¿åºœç‡Ÿé‹è£œåŠ©", "292,500å…ƒ/æœˆ", "ä¸­å¤®5,000å…ƒ + æ–°ç«¹å¸‚1,500å…ƒ Ã— 45äºº"],
        ["å®¶é•·ç¹³è²»", "360,000å…ƒ/æœˆ", "45äºº Ã— 8,000å…ƒ/æœˆ"],
        ["å…¬æ‰˜ç¸½æ”¶å…¥", "652,500å…ƒ/æœˆ", ""],
        ["", "", ""],
        ["âš ï¸ æ³¨æ„", "ä¸Šè¡¨ã€Œæ‰˜è‚²æ”¶è²»ã€585,000å…ƒç‚ºä¿å®ˆä¼°è¨ˆ", "å¯¦éš›å«æ”¿åºœè£œåŠ©å¯é”652,500å…ƒ"],
    ]

    for row in childcare_details:
        ws4.append(row)

    # æ ¼å¼åŒ–
    ws4.merge_cells('A1:E1')
    ws4['A1'].font = Font(size=14, bold=True, color="FFFFFF")
    ws4['A1'].fill = PatternFill(start_color="27AE60", end_color="27AE60", fill_type="solid")
    ws4['A1'].alignment = Alignment(horizontal="center")

    ws4.column_dimensions['A'].width = 25
    ws4.column_dimensions['B'].width = 20
    ws4.column_dimensions['C'].width = 18
    ws4.column_dimensions['D'].width = 12
    ws4.column_dimensions['E'].width = 35

    # ========== å·¥ä½œè¡¨ 5: æ•æ„Ÿåº¦åˆ†æ ==========
    ws5 = wb.create_sheet("5ï¸âƒ£ æ•æ„Ÿåº¦åˆ†æ")

    ws5.append(["èµ¤åœŸå´å…¨é½¡ç¤¾ç¦æ¨ç´ - æ•æ„Ÿåº¦åˆ†æ (ä¸åŒæ»¿è¼‰ç‡æƒ…å¢ƒ)"])
    ws5.append([])
    ws5.append(["æƒ…å¢ƒ", "æ»¿è¼‰ç‡", "æœˆæ”¶å…¥ (å…ƒ)", "æœˆæ”¯å‡º (å…ƒ)", "æœˆæ·¨æ”¶å…¥ (å…ƒ)", "ç‹€æ…‹", "è©•ä¼°"])

    sensitivity_data = [
        ["æœ€ä½³æƒ…å¢ƒ", "100%", 2778600, 2259050, 519550, "âœ… å¤§å¹…ç›ˆé¤˜", "ç†æƒ³ç‹€æ…‹ï¼Œå¯æ“´å±•æœå‹™"],
        ["æ¨™æº–æƒ…å¢ƒ", "90%", 2500740, 2259050, 241690, "âœ… ç©©å®šç›ˆé¤˜", "ç›®æ¨™ç‡Ÿé‹ç‹€æ…‹"],
        ["ä¿å®ˆæƒ…å¢ƒ", "80%", 2222880, 2259050, -36170, "âš ï¸ å¾®è™§", "å¯ç”³è«‹å°ˆæ¡ˆè£œåŠ©å¹³è¡¡"],
        ["å±æ©Ÿæƒ…å¢ƒ", "70%", 1945020, 2259050, -314030, "âŒ è™§æ", "éœ€èª¿æ•´ç­–ç•¥æˆ–ç”³è«‹ç·Šæ€¥è£œåŠ©"],
    ]

    for row in sensitivity_data:
        ws5.append(row)

    ws5.append([])
    ws5.append(["ğŸ“Š å¹´åº¦ç›ˆé¤˜è©¦ç®—"])
    ws5.append([])
    ws5.append(["æ»¿è¼‰ç‡", "æœˆæ·¨æ”¶å…¥ (å…ƒ)", "å¹´æ·¨æ”¶å…¥ (å…ƒ)", "ç›ˆé¤˜ç”¨é€”å»ºè­°"])

    annual_surplus = [
        ["100%", "519,550", "6,234,600", "è¨­æ–½å‡ç´š200è¬ + å“¡å·¥çé‡‘150è¬ + æœå‹™æ“´å±•100è¬ + æº–å‚™é‡‘173è¬"],
        ["90%", "241,690", "2,900,280", "å“¡å·¥çé‡‘100è¬ + è¨­æ–½ç¶­è­·100è¬ + æº–å‚™é‡‘90è¬"],
        ["80%", "-36,170", "-434,040", "ç”³è«‹å°ˆæ¡ˆè£œåŠ© + å„ªåŒ–ç‡Ÿé‹æ•ˆç‡"],
        ["70%", "-314,030", "-3,768,360", "ç·Šæ€¥æ‡‰è®Šï¼šèª¿æ•´æ”¶è²»/ç”³è«‹è£œåŠ©/ç­–ç•¥å„ªåŒ–"],
    ]

    for row in annual_surplus:
        ws5.append(row)

    ws5.append([])
    ws5.append(["ğŸ¯ é¢¨éšªæ§åˆ¶æªæ–½"])
    ws5.append([])
    ws5.append(["æ»¿è¼‰ç‡é–¾å€¼", "è¡Œå‹•æ–¹æ¡ˆ"])

    risk_control = [
        ["< 85%", "åŠ å¼·ç¤¾å€å®£å‚³ã€èˆ‡1999å°ˆç·šåˆä½œã€èˆ‰è¾¦é–‹æ”¾æ—¥æ´»å‹•"],
        ["< 80%", "å‘æ–°ç«¹å¸‚ç¤¾æœƒè™•ç”³è«‹å°ˆæ¡ˆè£œåŠ©ã€èª¿æ•´è¡ŒéŠ·ç­–ç•¥"],
        ["< 75%", "èª¿æ•´æ”¶è²»çµæ§‹ã€å„ªåŒ–æœå‹™å…§å®¹ã€æ“´å¤§æœå‹™å°è±¡ç¯„åœ"],
    ]

    for row in risk_control:
        ws5.append(row)

    # æ ¼å¼åŒ–
    ws5.merge_cells('A1:G1')
    ws5['A1'].font = Font(size=14, bold=True, color="FFFFFF")
    ws5['A1'].fill = PatternFill(start_color="F39C12", end_color="F39C12", fill_type="solid")
    ws5['A1'].alignment = Alignment(horizontal="center")

    ws5.column_dimensions['A'].width = 15
    ws5.column_dimensions['B'].width = 12
    ws5.column_dimensions['C'].width = 18
    ws5.column_dimensions['D'].width = 18
    ws5.column_dimensions['E'].width = 18
    ws5.column_dimensions['F'].width = 15
    ws5.column_dimensions['G'].width = 40

    # ========== å·¥ä½œè¡¨ 6: è³‡æœ¬æŠ•è³‡ ==========
    ws6 = wb.create_sheet("6ï¸âƒ£ è³‡æœ¬æŠ•è³‡")

    ws6.append(["èµ¤åœŸå´å…¨é½¡ç¤¾ç¦æ¨ç´ - åˆæœŸè³‡æœ¬æŠ•è³‡ (CAPEX)"])
    ws6.append([])
    ws6.append(["é …ç›®", "é‡‘é¡ (å…ƒ)", "ä½”æ¯”", "å‚™è¨»"])

    capex_data = [
        ["å»ºç¯‰å·¥ç¨‹", 180000000, "78.3%", "3,100mÂ² Ã— 58,000å…ƒ/mÂ² (å«çµæ§‹ã€å¤–è§€ã€å…§è£)"],
        ["è¨­å‚™è²»ç”¨", 30000000, "13.0%", "é•·ç…§+æ‰˜è‚²+é’å°‘å¹´+æ™ºæ…§ç³»çµ±è¨­å‚™"],
        ["è³‡è¨Šç³»çµ±", 5000000, "2.2%", "é ç´„ç³»çµ±ã€ç›£æ§ç³»çµ±ã€APPé–‹ç™¼"],
        ["è¦åŠƒè¨­è¨ˆç›£é€ ", 15000000, "6.5%", "å»ºç¯‰å¸«ã€çµæ§‹æŠ€å¸«ã€æ©Ÿé›»æŠ€å¸«è²»ç”¨"],
        ["ç¸½è¨ˆ", 230000000, "100%", "ç´„2.3å„„å…ƒ"],
    ]

    for row in capex_data:
        ws6.append(row)

    ws6.append([])
    ws6.append(["ğŸ’° è³‡é‡‘ä¾†æºè¦åŠƒ"])
    ws6.append([])
    ws6.append(["ä¾†æº", "é‡‘é¡ (å…ƒ)", "ä½”æ¯”", "èªªæ˜"])

    funding_data = [
        ["ä¸­å¤®è£œåŠ©", 33500000, "14.6%", "é•·ç…§2.0 + å‰ç»è¨ˆç•« + é’å°‘å¹´ç™¼å±• + å°ˆæ¡ˆè£œåŠ©"],
        ["  - é•·ç…§2.0è¨­æ–½è£œåŠ©", 12000000, "", "æ—¥ç…§ä¸­å¿ƒè¨­å‚™"],
        ["  - å‰ç»æ‰˜è‚²è£œåŠ©", 10000000, "", "å…¬æ‰˜ä¸­å¿ƒè¨­å‚™"],
        ["  - é’å°‘å¹´ä¸­å¿ƒè£œåŠ©", 1500000, "", "STEAMæ•™è‚²è¨­å‚™"],
        ["  - è²¡åŠƒæ³•å°ˆæ¡ˆè£œåŠ©", 10000000, "", "æ•´åˆæ€§å»ºè¨­"],
        ["æ–°ç«¹å¸‚æ”¿åºœé ç®—", 196500000, "85.4%", "è²¡åŠƒæ³•ä¿®æ­£å¾Œ+210å„„ï¼Œç¤¾ç¦é ç®—å¤§å¹…æå‡"],
        ["ç¸½è¨ˆ", 230000000, "100%", ""],
    ]

    for row in funding_data:
        ws6.append(row)

    ws6.append([])
    ws6.append(["ğŸ—ï¸ è¨­å‚™è£œåŠ©æ˜ç´°"])
    ws6.append([])
    ws6.append(["æ¨“å±¤", "è¨­å‚™é …ç›®", "é‡‘é¡ (å…ƒ)", "è£œåŠ©ä¾†æº"])

    equipment_details = [
        ["1F é•·ç…§", "ç„¡éšœç¤™é›»æ¢¯ã€å¡é“", "2,000,000", "é•·ç…§2.0"],
        ["1F é•·ç…§", "å¤±æ™ºç…§è­·å°ˆå€è¨­å‚™", "3,500,000", "é•·ç…§2.0"],
        ["1F é•·ç…§", "å¾©å¥å™¨æ (PT/OT)", "2,500,000", "é•·ç…§2.0"],
        ["1F é•·ç…§", "æ™ºæ…§ç›£æ§ç³»çµ±", "2,000,000", "é•·ç…§2.0"],
        ["1F é•·ç…§", "ç·Šæ€¥æ•‘è­·è¨­å‚™", "1,500,000", "é•·ç…§2.0"],
        ["1F é•·ç…§", "æ²æµ´ç…§è­·è¨­å‚™", "500,000", "é•·ç…§2.0"],
        ["", "é•·ç…§å°è¨ˆ", "12,000,000", ""],
        ["2F æ‰˜è‚²", "å¬°å¹¼å…’å®‰å…¨è¨­æ–½", "1,500,000", "å‰ç»è¨ˆç•«"],
        ["2F æ‰˜è‚²", "æ•™ä¿è¨­å‚™ (è’™ç‰¹æ¢­åˆ©)", "2,000,000", "å‰ç»è¨ˆç•«"],
        ["2F æ‰˜è‚²", "å»šæˆ¿è¨­å‚™", "1,500,000", "å‰ç»è¨ˆç•«"],
        ["2F æ‰˜è‚²", "ç›£è¦–ç³»çµ± (å®¶é•·APP)", "1,000,000", "å‰ç»è¨ˆç•«"],
        ["2F æ‰˜è‚²", "éŠæˆ²ç©ºé–“è¨­æ–½", "2,500,000", "å‰ç»è¨ˆç•«"],
        ["2F æ‰˜è‚²", "ç¡çœ å€è¨­å‚™", "1,500,000", "å‰ç»è¨ˆç•«"],
        ["", "æ‰˜è‚²å°è¨ˆ", "10,000,000", ""],
        ["4F é’å°‘å¹´", "STEAMæ•™è‚²è¨­å‚™", "1,500,000", "é’å°‘å¹´ç™¼å±•è£œåŠ© + è¯ç™¼ç§‘æè´ˆ"],
        ["", "è¨­å‚™ç¸½è¨ˆ", "23,500,000", ""],
    ]

    for row in equipment_details:
        ws6.append(row)

    # æ ¼å¼åŒ–
    ws6.merge_cells('A1:D1')
    ws6['A1'].font = Font(size=14, bold=True, color="FFFFFF")
    ws6['A1'].fill = PatternFill(start_color="8E44AD", end_color="8E44AD", fill_type="solid")
    ws6['A1'].alignment = Alignment(horizontal="center")

    ws6.column_dimensions['A'].width = 20
    ws6.column_dimensions['B'].width = 30
    ws6.column_dimensions['C'].width = 18
    ws6.column_dimensions['D'].width = 35

    # ========== å·¥ä½œè¡¨ 7: ä¼æ¥­ESGåˆä½œ ==========
    ws7 = wb.create_sheet("7ï¸âƒ£ ä¼æ¥­ESGåˆä½œ")

    ws7.append(["èµ¤åœŸå´å…¨é½¡ç¤¾ç¦æ¨ç´ - ä¼æ¥­ESGåˆä½œæ–¹æ¡ˆ"])
    ws7.append([])
    ws7.append(["ä¼æ¥­", "åˆä½œæ–¹æ¡ˆ", "å¹´åº¦é‡‘é¡ (å…ƒ)", "é¦–å¹´é‡‘é¡ (å…ƒ)", "åˆä½œäº®é»"])

    esg_data = [
        ["å°ç©é›»æ…ˆå–„åŸºé‡‘æœƒ", "ç«¹ç§‘å®¶åº­ç…§è­·æ™‚æ•¸éŠ€è¡Œ", "5,000,000", "5,000,000", "è³¼è²·10,000å°æ™‚æœå‹™ + å“¡å·¥å¿—å·¥ + ESGå ±å‘Š"],
        ["è¯ç™¼ç§‘æ•™è‚²åŸºé‡‘æœƒ", "ç§‘æŠ€å‰µå®¢é’å°‘å¹´åŸ¹è‚²", "900,000", "2,900,000", "STEAMè¨­å‚™æè´ˆ + ç¨‹å¼èª²ç¨‹ + çå­¸é‡‘"],
        ["å°é”é›»å­åŸºé‡‘æœƒ", "ç¯€èƒ½è¨­å‚™èˆ‡ç¶ å»ºç¯‰", "1,000,000", "1,000,000", "ç¯€èƒ½è¨­å‚™æè´ˆ + æŠ€è¡“æ”¯æ´"],
        ["ç ”è¯æ–‡æ•™åŸºé‡‘æœƒ", "ç‰©è¯ç¶²æ™ºæ…§ç³»çµ±", "800,000", "800,000", "æ™ºæ…§ç›£æ§ + æ•¸ä½å­¸ç¿’å¹³å°"],
        ["æ—¥æœˆå…‰æ–‡æ•™åŸºé‡‘æœƒ", "å¼±å‹¢å®¶åº­æ”¯æŒ", "500,000", "500,000", "èª²è¼”è¨ˆç•« + å®¶åº­æ”¯æŒ"],
        ["æ–°ç«¹ç‰©æµ", "ç¤¾å€å…±é¤ç‰©æµ", "300,000", "300,000", "é£Ÿæé…é€ + ç‰©æµæ”¯æ´"],
        ["å…¶ä»–ä¸­å°ä¼æ¥­", "å°é¡è´ŠåŠ©", "1,000,000", "1,000,000", "åœ¨åœ°ä¼æ¥­CSR + å† åè´ŠåŠ©"],
        ["ç¸½è¨ˆ", "", "9,500,000", "11,500,000", "é™ä½å…¬å¸‘è² æ“” 28.5%"],
    ]

    for row in esg_data:
        ws7.append(row)

    ws7.append([])
    ws7.append(["ğŸ“‹ å°ç©é›»åˆä½œè©³ç´°æ–¹æ¡ˆ"])
    ws7.append([])
    ws7.append(["åˆä½œå…§å®¹", "è¦æ ¼", "å¹´åº¦é‡‘é¡ (å…ƒ)"])

    tsmc_details = [
        ["ä¼æ¥­è³¼è²·æœå‹™æ™‚æ•¸", "10,000å°æ™‚/å¹´ Ã— 500å…ƒ/å°æ™‚", "5,000,000"],
        ["å“¡å·¥ç¦åˆ©å…Œæ›æœå‹™", "æ—¥ç…§ã€æ‰˜è‚²ã€è«®å•†æœå‹™", "åŒ…å«æ–¼ä¸Šè¿°"],
        ["å“¡å·¥å¿—å·¥è¨ˆç•«", "é’å°‘å¹´è·æ¶¯å°å¸« (æ¯æœˆ1æ¬¡)", "ç„¡å„Ÿ"],
        ["STEAMèª²ç¨‹æ•™å­¸", "å·¥ç¨‹å¸«æ•™ç¨‹å¼ã€AIèª²ç¨‹", "ç„¡å„Ÿ"],
        ["ESGå ±å‘Šç´ æ", "æœå‹™æ•¸æ“š + å½±ç‰‡ + SROIå ±å‘Š", "ç„¡å„Ÿ"],
    ]

    for row in tsmc_details:
        ws7.append(row)

    ws7.append([])
    ws7.append(["ğŸ“‹ è¯ç™¼ç§‘åˆä½œè©³ç´°æ–¹æ¡ˆ"])
    ws7.append([])
    ws7.append(["åˆä½œå…§å®¹", "è¦æ ¼", "é‡‘é¡ (å…ƒ)"])

    mediatek_details = [
        ["STEAMè¨­å‚™æè´ˆ (é¦–å¹´)", "Arduinoã€3Dåˆ—å°ã€VR/ARè¨­å‚™", "2,000,000"],
        ["ç¨‹å¼æ•™è‚²èª²ç¨‹ (æ¯å¹´)", "è¬›å¸«æˆèª²æ¯æœˆ4æ¬¡", "600,000"],
        ["å¯’æš‘å‡å¯†é›†ç‡ŸéšŠ", "5å¤©ç‡ŸéšŠï¼Œæ¯æ¢¯æ¬¡30äºº", "åŒ…å«æ–¼ä¸Šè¿°"],
        ["å¹´åº¦é»‘å®¢æ¾ç«¶è³½", "çé‡‘20è¬å…ƒ", "200,000"],
        ["å¼±å‹¢é’å°‘å¹´çå­¸é‡‘", "10å Ã— 30,000å…ƒ", "300,000"],
        ["è·æ¶¯è¼”å°", "æ¨è–¦å¯¦ç¿’æ©Ÿæœƒ", "ç„¡å„Ÿ"],
        ["é¦–å¹´ç¸½è¨ˆ", "", "2,900,000"],
        ["æ¬¡å¹´èµ·æ¯å¹´", "", "900,000"],
    ]

    for row in mediatek_details:
        ws7.append(row)

    # æ ¼å¼åŒ–
    ws7.merge_cells('A1:E1')
    ws7['A1'].font = Font(size=14, bold=True, color="FFFFFF")
    ws7['A1'].fill = PatternFill(start_color="16A085", end_color="16A085", fill_type="solid")
    ws7['A1'].alignment = Alignment(horizontal="center")

    ws7.column_dimensions['A'].width = 25
    ws7.column_dimensions['B'].width = 30
    ws7.column_dimensions['C'].width = 20
    ws7.column_dimensions['D'].width = 20
    ws7.column_dimensions['E'].width = 40

    # ========== å·¥ä½œè¡¨ 8: è£œåŠ©ç”³è«‹æ™‚ç¨‹ ==========
    ws8 = wb.create_sheet("8ï¸âƒ£ è£œåŠ©ç”³è«‹æ™‚ç¨‹")

    ws8.append(["èµ¤åœŸå´å…¨é½¡ç¤¾ç¦æ¨ç´ - è£œåŠ©ç”³è«‹æ™‚ç¨‹è¡¨"])
    ws8.append([])
    ws8.append(["è£œåŠ©é …ç›®", "ç”³è«‹æ™‚é–“", "å¯©æ ¸æœŸ", "æ’¥æ¬¾æ™‚é–“", "é‡‘é¡ (å…ƒ)", "æ‰¿è¾¦å–®ä½"])

    timeline_data = [
        ["é•·ç…§2.0è¨­æ–½è£œåŠ©", "2026å¹´1æœˆ", "2-3å€‹æœˆ", "2026å¹´4æœˆ", "12,000,000", "è¡›ç¦éƒ¨ç¤¾å®¶ç½²"],
        ["å‰ç»æ‰˜è‚²è£œåŠ©", "2026å¹´2æœˆ", "3-4å€‹æœˆ", "2026å¹´6æœˆ", "10,000,000", "æ•™è‚²éƒ¨åœ‹æ•™ç½²"],
        ["é’å°‘å¹´ç™¼å±•è£œåŠ©", "2026å¹´3æœˆ", "1-2å€‹æœˆ", "2026å¹´5æœˆ", "1,500,000", "æ–°ç«¹å¸‚ç¤¾æœƒè™•"],
        ["è²¡åŠƒæ³•å°ˆæ¡ˆè£œåŠ©", "2026å¹´1æœˆ", "2å€‹æœˆ", "2026å¹´3æœˆ", "10,000,000", "æ–°ç«¹å¸‚æ”¿åºœ"],
        ["ç¸½è¨ˆ", "", "", "", "33,500,000", ""],
    ]

    for row in timeline_data:
        ws8.append(row)

    ws8.append([])
    ws8.append(["ğŸ—“ï¸ é—œéµæ™‚ç¨‹é‡Œç¨‹ç¢‘"])
    ws8.append([])
    ws8.append(["æ™‚é–“", "äº‹é …", "èªªæ˜"])

    milestones = [
        ["2025å¹´10æœˆ30æ—¥", "èµ¤åœŸå´æ¨™æ¡ˆé–‹æ¨™", "ğŸ”¥ è¦åŠƒè¨­è¨ˆæ¨™æ¡ˆ (2,287è¬å…ƒ)"],
        ["2025å¹´11æœˆ8-28æ—¥", "è¨­è¨ˆéšæ®µéœ€æ±‚è¨ªè«‡", "â­ é»ƒé‡‘çª—å£ï¼šç´å…¥æ•´åˆåŠŸèƒ½çš„æœ€å¾Œæ©Ÿæœƒ"],
        ["2025å¹´12æœˆ", "ä¼æ¥­ESGæ´½è«‡", "å°ç©é›»ã€è¯ç™¼ç§‘åˆä½œæ„å‘æ›¸ç°½ç½²"],
        ["2026å¹´1-3æœˆ", "è£œåŠ©ç”³è«‹éä»¶", "é•·ç…§2.0 + å‰ç»è¨ˆç•« + å°ˆæ¡ˆè£œåŠ©"],
        ["2026å¹´2æœˆ", "å»ºç¯‰è¦åŠƒè¨­è¨ˆå®Œæˆ", "å«B1+4Få®Œæ•´è¨­è¨ˆåœ–"],
        ["2026å¹´4-6æœˆ", "ä¸­å¤®è£œåŠ©æ ¸å®š", "é è¨ˆå–å¾—3,350è¬å…ƒè£œåŠ©"],
        ["2026å¹´Q2", "å·¥ç¨‹ç™¼åŒ…", "ä¸»é«”å·¥ç¨‹ç´„1.8å„„å…ƒ"],
        ["2026å¹´3æœˆèµ·", "äººåŠ›æ‹›å‹Ÿèˆ‡è¨“ç·´", "29åå“¡å·¥æ‹›å‹Ÿã€åŸ¹è¨“"],
        ["2027å¹´Q1", "è©¦ç‡Ÿé‹", "è»Ÿé«”é–‹å¹•ã€æœå‹™æ¸¬è©¦"],
        ["2027å¹´Q2", "æ­£å¼ç‡Ÿé‹", "å…¨é¢å°å¤–æœå‹™"],
    ]

    for row in milestones:
        ws8.append(row)

    # æ ¼å¼åŒ–
    ws8.merge_cells('A1:F1')
    ws8['A1'].font = Font(size=14, bold=True, color="FFFFFF")
    ws8['A1'].fill = PatternFill(start_color="2980B9", end_color="2980B9", fill_type="solid")
    ws8['A1'].alignment = Alignment(horizontal="center")

    ws8.column_dimensions['A'].width = 25
    ws8.column_dimensions['B'].width = 20
    ws8.column_dimensions['C'].width = 15
    ws8.column_dimensions['D'].width = 20
    ws8.column_dimensions['E'].width = 18
    ws8.column_dimensions['F'].width = 25

    # ä¿å­˜å·¥ä½œç°¿
    filename = "èµ¤åœŸå´å…¨é½¡ç¤¾ç¦æ¨ç´_è²¡å‹™è©¦ç®—è¡¨_2025.xlsx"
    wb.save(filename)
    print(f"[SUCCESS] Excel file created: {filename}")
    print(f"[INFO] Contains 8 worksheets:")
    print(f"   [1] Overview - Key Financial Metrics")
    print(f"   [2] Staffing - 29 Employees Details")
    print(f"   [3] Operating Costs - Monthly/Annual Analysis")
    print(f"   [4] Revenue Streams - Multiple Income Sources")
    print(f"   [5] Sensitivity Analysis - Occupancy Scenarios")
    print(f"   [6] Capital Investment - CAPEX & Funding")
    print(f"   [7] Corporate ESG - TSMC & MediaTek Plans")
    print(f"   [8] Subsidy Timeline - Application Schedule")
    print(f"\n[FEATURES]")
    print(f"   - Complete data from policy-docking-and-financial-model.md")
    print(f"   - Professional formatting with colors and categories")
    print(f"   - Ready for hackathon presentation")

    return filename

if __name__ == "__main__":
    create_financial_workbook()
