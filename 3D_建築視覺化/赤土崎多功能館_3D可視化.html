<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èµ¤åœŸå´å¤šåŠŸèƒ½é¤¨ - 3Då»ºç¯‰å¯è¦–åŒ– (2028å¹´è½æˆ)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
            height: 100vh;
        }

        #canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* ä¿¡æ¯é¢æ¿ */
        #info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 20px;
            border-radius: 10px;
            max-width: 350px;
            font-size: 13px;
            z-index: 10;
            border: 2px solid #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        #info-panel h1 {
            font-size: 20px;
            margin-bottom: 10px;
            color: #667eea;
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.8);
        }

        #info-panel h2 {
            font-size: 16px;
            margin-top: 15px;
            margin-bottom: 8px;
            color: #764ba2;
            border-bottom: 1px solid #764ba2;
            padding-bottom: 5px;
        }

        .spec-row {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .spec-label {
            color: #aaa;
        }

        .spec-value {
            color: #fff;
            font-weight: bold;
        }

        /* æ¨“å±¤ä¿¡æ¯ */
        #floor-info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 20px;
            border-radius: 10px;
            max-width: 300px;
            font-size: 13px;
            z-index: 10;
            border: 2px solid #764ba2;
            box-shadow: 0 0 20px rgba(118, 75, 162, 0.5);
        }

        #floor-info h3 {
            font-size: 14px;
            margin-bottom: 10px;
            color: #764ba2;
        }

        /* åº•éƒ¨æ§åˆ¶é¢æ¿ */
        #controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 10;
            border: 2px solid #667eea;
            text-align: center;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        #controls p {
            margin: 5px 0;
            font-size: 13px;
            color: #aaa;
        }

        .floor-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 12px;
            margin: 5px 2px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .floor-button:hover {
            background: #764ba2;
            transform: scale(1.1);
        }

        .floor-button.active {
            background: #00ff88;
            color: black;
            box-shadow: 0 0 10px #00ff88;
        }

        /* åŠ è¼‰å‹•ç•« */
        .loader {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* çµ±è¨ˆä¿¡æ¯ */
        #stats {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.6);
            color: #0f0;
            padding: 10px 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="loader" id="loader">
        <div class="spinner"></div>
    </div>

    <div id="info-panel">
        <h1>ğŸ¢ èµ¤åœŸå´å¤šåŠŸèƒ½é¤¨</h1>
        <div class="spec-row">
            <span class="spec-label">å®Œå·¥æ™‚é–“ï¼š</span>
            <span class="spec-value">2028å¹´</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">å»ºç¯‰è¦æ¨¡ï¼š</span>
            <span class="spec-value">3,833 mÂ²</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">æ¨“å±¤ï¼š</span>
            <span class="spec-value">6æ¨“ (B1-6F)</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">å»ºç¯‰é«˜åº¦ï¼š</span>
            <span class="spec-value">~26.5m</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">æ¨“å±¤é¢ç©ï¼š</span>
            <span class="spec-value">640 mÂ²/å±¤</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">å»ºé€ æˆæœ¬ï¼š</span>
            <span class="spec-value">NT$228.7M</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">å¹´åº¦ç‡Ÿé‹ï¼š</span>
            <span class="spec-value">NT$15.96M</span>
        </div>

        <h2>ğŸ“ å»ºç¯‰è¨­è¨ˆ</h2>
        <div class="spec-row">
            <span class="spec-label">è¨­è¨ˆå“²å­¸ï¼š</span>
            <span class="spec-value">å…‰å½±æ¨“é–£</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">ç„¡éšœç¤™è¨­è¨ˆï¼š</span>
            <span class="spec-value">å…¨é¤¨ç„¡éšœç¤™</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">ç¶ èƒ½ç³»çµ±ï¼š</span>
            <span class="spec-value">å¤ªé™½èƒ½50kWp</span>
        </div>

        <h2>ğŸ¯ æ ¸å¿ƒåŠŸèƒ½</h2>
        <div class="spec-row">
            <span class="spec-label">é•·ç…§æ—¥ç…§ï¼š</span>
            <span class="spec-value">80äºº/æ—¥</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">å…¬å…±æ‰˜å¬°ï¼š</span>
            <span class="spec-value">50äºº/æ—¥</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">è¦ªå­å…±å­¸ï¼š</span>
            <span class="spec-value">60å®¶åº­</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">é’å°‘å¹´æ´»å‹•ï¼š</span>
            <span class="spec-value">100äºº</span>
        </div>
        <div class="spec-row">
            <span class="spec-label">å¹´åº¦å—æƒ ï¼š</span>
            <span class="spec-value">45,000äººæ¬¡</span>
        </div>
    </div>

    <div id="floor-info">
        <h3>ğŸ“ ç•¶å‰æ¨“å±¤</h3>
        <div id="current-floor-name" style="font-size: 16px; color: #764ba2; margin-bottom: 10px;">6F - å…¬å…±æœƒè­°å»³</div>
        <div id="current-floor-desc" style="font-size: 12px; color: #aaa; line-height: 1.6;">
            å¤šåŠŸèƒ½æœƒè­°å»³ï¼ˆ300äººå®¹ç´ï¼‰ï¼Œå±‹é ‚éœ²è‡ºçœºæœ›èµ¤åœŸå´å…¬åœ’èˆ‡ç«¹ç§‘åœ’å€ã€‚
        </div>
    </div>

    <div id="controls">
        <p>ğŸ–±ï¸ æ»‘é¼ æ‹–å‹•æ—‹è½‰ | æ»¾è¼ªç¸®æ”¾ | å³éµå¹³ç§»</p>
        <div>
            <button class="floor-button" onclick="highlightFloor('B1')">B1 åœè»Š+æ©Ÿæˆ¿</button>
            <button class="floor-button" onclick="highlightFloor('1F')">1F é•·ç…§</button>
            <button class="floor-button" onclick="highlightFloor('2F')">2F æ‰˜å¬°</button>
            <button class="floor-button" onclick="highlightFloor('3F')">3F å®¶åº­</button>
            <button class="floor-button" onclick="highlightFloor('4F')">4F é’å°‘å¹´</button>
            <button class="floor-button" onclick="highlightFloor('5F')">5F ç¶ èƒ½</button>
            <button class="floor-button active" onclick="highlightFloor('6F')">6F æœƒè­°å»³</button>
        </div>
    </div>

    <div id="stats">
        <div>FPS: <span id="fps">60</span></div>
        <div>Objects: <span id="obj-count">0</span></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@r128/examples/js/controls/OrbitControls.js"></script>

    <script>
        // ==================== å»ºç¯‰è¦åŠƒæ•¸æ“š ====================
        const buildingSpec = {
            name: 'èµ¤åœŸå´å¤šåŠŸèƒ½é¤¨',
            floors: {
                B1: { name: 'B1 - åœè»Šå ´+æ©Ÿæˆ¿', height: 5, description: 'åœ°é¢åœè»Š60è»Šä½ã€ç©ºèª¿æ©Ÿæˆ¿ã€é…é›»å®¤ã€UPSã€çµ¦æ’æ°´ç³»çµ±ã€å€å¡Šéˆç¯€é»' },
                '1F': { name: '1F - AIè¨˜æ†¶é‡ç”Ÿ+é•·ç…§æ—¥ç…§', height: 4, description: 'å¤±æ™ºç—‡å°ˆå€(200 mÂ²)ã€æŠ•å½±é«”é©—ã€ç©¿æˆ´ç›£æ¸¬ã€æ—¥ç…§æ´»å‹•å€(80äºº)' },
                '2F': { name: '2F - SIDSç›£æ¸¬+å…¬å…±æ‰˜å¬°', height: 3.5, description: 'SIDSç›£æ¸¬ç³»çµ±(50åºŠ)ã€æ‰˜å¬°æ´»å‹•å€ã€æ„ŸæŸ“éš”é›¢è¨­è¨ˆ' },
                '3F': { name: '3F - è¦ªå­å…±å­¸+æ™‚é–“éŠ€è¡Œ', height: 3.5, description: 'è¦ªå­å…±å­¸å€ã€æ™‚é–“éŠ€è¡Œç®¡ç†ä¸­å¿ƒã€MRäº’å‹•ç©ºé–“ã€æ•…äº‹åŠ‡å ´' },
                '4F': { name: '4F - å…ƒå®‡å®™å…±å­¸æ•™å®¤+é’å°‘å¹´', height: 3.5, description: 'STEMæ•™å®¤ã€VRæ²‰æµ¸æ•™å®¤ã€è·æ¶¯å°å¸«å€ã€é è·æ•™å­¸' },
                '5F': { name: '5F - ç¶ èƒ½+å¤šåŠŸèƒ½åŸ¹è¨“', height: 3.5, description: 'å¤ªé™½èƒ½50kWpã€ç¶ å±‹é ‚ã€å“¡å·¥åŸ¹è¨“ä¸­å¿ƒã€ç ”ç©¶å¯¦é©—å®¤' },
                '6F': { name: '6F - å…¬å…±æœƒè­°å»³+éœ²è‡º', height: 3.5, description: 'å¤šåŠŸèƒ½æœƒè­°å»³(300äºº)ã€å±‹é ‚éœ²è‡º(200 mÂ²)ã€çœºæœ›èµ¤åœŸå´å…¬åœ’' }
            }
        };

        // ==================== Three.js å ´æ™¯åˆå§‹åŒ– ====================
        let scene, camera, renderer, controls;
        let building, floors = {};
        let currentFloor = '6F';
        let frameCount = 0, lastTime = Date.now(), fps = 0;

        function init() {
            // å ´æ™¯
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x667eea);
            scene.fog = new THREE.Fog(0x667eea, 100, 500);

            // ç›¸æ©Ÿ
            camera = new THREE.PerspectiveCamera(
                75,
                window.innerWidth / window.innerHeight,
                0.1,
                10000
            );
            camera.position.set(50, 40, 50);
            camera.lookAt(0, 10, 0);

            // æ¸²æŸ“å™¨
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFShadowShadowMap;
            document.body.appendChild(renderer.domElement);

            // æ§åˆ¶
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.autoRotate = false;
            controls.autoRotateSpeed = 2;
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.maxDistance = 200;
            controls.minDistance = 20;

            // å»ºç¯‰
            createBuilding();

            // å…‰æº
            createLights();

            // åœ°é¢
            createGround();

            // çª—å£èª¿æ•´
            window.addEventListener('resize', onWindowResize, false);

            // éš±è—åŠ è¼‰å™¨
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
            }, 500);

            // å‹•ç•«å¾ªç’°
            animate();
        }

        // ==================== å»ºç¯‰å‰µå»º ====================
        function createBuilding() {
            building = new THREE.Group();
            scene.add(building);

            // æ¨“å±¤é«˜åº¦è¨ˆç®—
            let currentHeight = 0;
            const floorOrder = ['B1', '1F', '2F', '3F', '4F', '5F', '6F'];
            const floorColors = {
                B1: 0x7a7a7a,  // æ·±ç°è‰²ï¼ˆæ©Ÿæˆ¿çœ‹ä¸è¦‹ï¼‰
                '1F': 0x9a9a9a, // æš–ç°è‰²
                '2F': 0x9a9a9a, // æš–ç°è‰²
                '3F': 0xb0b0b0, // æ·ºç°è‰²
                '4F': 0xf5f5f5, // ç™½è‰²
                '5F': 0xf5f5f5, // ç™½è‰²
                '6F': 0xf0f0f0  // ç™½è‰²
            };

            // å»ºç¯‰åº•åº§å°ºå¯¸ (estimated from 3,833 mÂ² / 6å±¤ = 640 mÂ²/å±¤)
            // å‡è¨­æ¯å±¤ç´„ 32m Ã— 20m
            const buildingWidth = 32;
            const buildingDepth = 20;

            floorOrder.forEach((floorKey, index) => {
                const floorData = buildingSpec.floors[floorKey];
                const floorHeight = floorData.height;

                // å‰µå»ºæ¨“å±¤ç›’å­
                const geometry = new THREE.BoxGeometry(buildingWidth, floorHeight, buildingDepth);

                // ç‚ºä¸åŒæ¨“å±¤æ‡‰ç”¨ä¸åŒæè³ª
                let material;
                if (floorKey === '3F') {
                    // 3Fï¼š50%ç»ç’ƒé€æ˜ + 50%ç°è‰²
                    material = new THREE.MeshPhongMaterial({
                        color: 0xb0b0b0,
                        transparent: true,
                        opacity: 0.7,
                        emissive: 0x333333,
                        shininess: 100
                    });
                } else if (['4F', '5F', '6F'].includes(floorKey)) {
                    // 4F-6Fï¼šç™½è‰²ç»ç’ƒå¹•ç‰†
                    material = new THREE.MeshPhongMaterial({
                        color: 0xffffff,
                        transparent: true,
                        opacity: 0.85,
                        emissive: 0x444444,
                        shininess: 80
                    });
                } else {
                    // B1, 1F, 2Fï¼šæš–ç°è‰²æ¸…æ°´æ··å‡åœŸ
                    material = new THREE.MeshPhongMaterial({
                        color: floorColors[floorKey],
                        emissive: 0x333333,
                        shininess: 60
                    });
                }

                const mesh = new THREE.Mesh(geometry, material);
                mesh.castShadow = true;
                mesh.receiveShadow = true;
                mesh.position.y = currentHeight + floorHeight / 2;
                mesh.userData = { floor: floorKey };

                // æ·»åŠ é‚Šæ¡†ç·šæ¢ï¼ˆè±¡å¾µå‚ç›´ç´°ç¸«ï¼‰
                const edges = new THREE.EdgesGeometry(geometry);
                const lineSegments = new THREE.LineSegments(
                    edges,
                    new THREE.LineBasicMaterial({ color: 0x333333, linewidth: 2 })
                );
                lineSegments.position.copy(mesh.position);
                building.add(lineSegments);

                building.add(mesh);
                floors[floorKey] = { mesh, height: floorHeight, position: mesh.position.y };

                currentHeight += floorHeight;
            });

            // å±‹é ‚è¨­è¨ˆï¼šå¤ªé™½èƒ½é¢æ¿ + ç¶ å±‹é ‚
            createRoof(currentHeight, buildingWidth, buildingDepth);

            // å…¥å£å»£å ´åœ°é¢
            createEntrance(buildingWidth, buildingDepth);
        }

        function createRoof(yPosition, width, depth) {
            // å¤ªé™½èƒ½é¢æ¿ï¼ˆè—è‰²æ¢¯ç”°å¼ï¼‰
            const panelCount = 12;
            for (let i = 0; i < panelCount; i++) {
                const panelGeometry = new THREE.BoxGeometry(
                    width / 4,
                    0.1,
                    depth / 3
                );
                const panelMaterial = new THREE.MeshPhongMaterial({
                    color: 0x1e90ff, // è—è‰²
                    emissive: 0x0066cc,
                    shininess: 100
                });
                const panelMesh = new THREE.Mesh(panelGeometry, panelMaterial);
                panelMesh.position.set(
                    -8 + (i % 4) * 5,
                    yPosition + 0.1,
                    -5 + Math.floor(i / 4) * 5
                );
                panelMesh.castShadow = true;
                panelMesh.receiveShadow = true;
                building.add(panelMesh);
            }

            // ç¶ å±‹é ‚ï¼ˆç¶ è‰²ï¼‰
            const greenRoofGeometry = new THREE.PlaneGeometry(width * 0.8, depth * 0.8);
            const greenRoofMaterial = new THREE.MeshPhongMaterial({
                color: 0x228b22, // æ£®æ—ç¶ 
                emissive: 0x1a6b1a,
                shininess: 30
            });
            const greenRoof = new THREE.Mesh(greenRoofGeometry, greenRoofMaterial);
            greenRoof.rotation.x = -Math.PI / 2;
            greenRoof.position.set(0, yPosition + 0.15, 0);
            greenRoof.receiveShadow = true;
            building.add(greenRoof);

            // é ‚éƒ¨é®é™½æ£šï¼ˆæ¸…æ°´æ··å‡åœŸï¼‰
            const topCanopyGeometry = new THREE.BoxGeometry(width, 0.2, depth);
            const topCanopyMaterial = new THREE.MeshPhongMaterial({
                color: 0x808080
            });
            const topCanopy = new THREE.Mesh(topCanopyGeometry, topCanopyMaterial);
            topCanopy.position.y = yPosition + 0.3;
            topCanopy.castShadow = true;
            topCanopy.receiveShadow = true;
            building.add(topCanopy);
        }

        function createEntrance(width, depth) {
            // å…¥å£å»£å ´
            const entranceGeometry = new THREE.PlaneGeometry(width * 2, depth * 1.5);
            const entranceMaterial = new THREE.MeshPhongMaterial({
                color: 0xcccccc, // æ·ºç°è‰²æ··å‡åœŸ
                side: THREE.DoubleSide
            });
            const entrance = new THREE.Mesh(entranceGeometry, entranceMaterial);
            entrance.rotation.x = -Math.PI / 2;
            entrance.position.y = -0.1;
            entrance.receiveShadow = true;
            building.add(entrance);

            // å»£å ´é‚Šç•Œ
            const boundaryGeometry = new THREE.BufferGeometry();
            const boundaryPoints = [
                new THREE.Vector3(-width, 0, -depth * 0.75),
                new THREE.Vector3(width, 0, -depth * 0.75),
                new THREE.Vector3(width, 0, depth * 0.75),
                new THREE.Vector3(-width, 0, depth * 0.75),
                new THREE.Vector3(-width, 0, -depth * 0.75)
            ];
            boundaryGeometry.setFromPoints(boundaryPoints);
            const boundaryLine = new THREE.Line(
                boundaryGeometry,
                new THREE.LineBasicMaterial({ color: 0x888888, linewidth: 2 })
            );
            building.add(boundaryLine);
        }

        // ==================== å…‰æºè¨­ç½® ====================
        function createLights() {
            // ç’°å¢ƒå…‰
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);

            // æ–¹å‘å…‰ï¼ˆæ¨¡æ“¬é™½å…‰ï¼‰
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(40, 60, 40);
            directionalLight.target.position.set(0, 10, 0);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            directionalLight.shadow.camera.far = 200;
            directionalLight.shadow.camera.left = -100;
            directionalLight.shadow.camera.right = 100;
            directionalLight.shadow.camera.top = 100;
            directionalLight.shadow.camera.bottom = -100;
            scene.add(directionalLight);

            // åŠçƒå…‰ï¼ˆå¤©ç©ºå…‰ï¼‰
            const hemisphereLight = new THREE.HemisphereLight(0x87ceeb, 0xb8860b, 0.4);
            scene.add(hemisphereLight);

            // é»å…‰æºï¼ˆè£é£¾æ€§ç…§æ˜ï¼‰
            const pointLight = new THREE.PointLight(0xffaa44, 0.3);
            pointLight.position.set(-50, 50, 50);
            scene.add(pointLight);
        }

        // ==================== åœ°é¢ ====================
        function createGround() {
            const groundGeometry = new THREE.PlaneGeometry(200, 200);
            const groundMaterial = new THREE.MeshPhongMaterial({
                color: 0x2d5016, // æ·±ç¶ è‰²ï¼ˆè‰åªï¼‰
                side: THREE.DoubleSide
            });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            ground.position.y = -0.5;
            ground.receiveShadow = true;
            scene.add(ground);

            // é æ™¯ï¼ˆèµ¤åœŸå´å…¬åœ’åƒè€ƒï¼‰
            const parkGeometry = new THREE.PlaneGeometry(300, 200);
            const parkMaterial = new THREE.MeshPhongMaterial({
                color: 0x2d5016,
                side: THREE.DoubleSide
            });
            const park = new THREE.Mesh(parkGeometry, parkMaterial);
            park.rotation.x = -Math.PI / 2;
            park.position.set(0, -0.4, -100);
            scene.add(park);
        }

        // ==================== æ¨“å±¤é«˜äº® ====================
        function highlightFloor(floorKey) {
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.floor-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // æ›´æ–°æ¨“å±¤ä¿¡æ¯
            const floorData = buildingSpec.floors[floorKey];
            document.getElementById('current-floor-name').textContent = floorData.name;
            document.getElementById('current-floor-desc').textContent = floorData.description;

            // é«˜äº®æ¨“å±¤
            Object.keys(floors).forEach(key => {
                const floorMesh = floors[key].mesh;
                if (key === floorKey) {
                    floorMesh.material.emissive.setHex(0x667eea);
                    floorMesh.material.emissiveIntensity = 0.8;
                } else {
                    floorMesh.material.emissive.setHex(0x333333);
                    floorMesh.material.emissiveIntensity = 0.2;
                }
            });

            currentFloor = floorKey;

            // ç›¸æ©Ÿä½ç½®èª¿æ•´
            const floorPos = floors[floorKey].position;
            const targetY = floorPos + 15;
            const currentPos = camera.position;
            const duration = 1000; // ms
            const startTime = Date.now();

            const animate = () => {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);

                camera.position.y = currentPos.y + (targetY - currentPos.y) * progress;

                if (progress < 1) {
                    requestAnimationFrame(animate);
                }
            };

            animate();
        }

        // ==================== å‹•ç•«å¾ªç’° ====================
        function animate() {
            requestAnimationFrame(animate);

            // æ›´æ–°çµ±è¨ˆ
            frameCount++;
            const now = Date.now();
            if (now >= lastTime + 1000) {
                fps = frameCount;
                frameCount = 0;
                lastTime = now;
                document.getElementById('fps').textContent = fps;
                document.getElementById('obj-count').textContent = scene.children.length;
            }

            // æ§åˆ¶è‡ªå‹•æ—‹è½‰ï¼ˆå¯é¸ï¼‰
            if (!controls.isDragging) {
                building.rotation.y += 0.0005;
            }

            controls.update();
            renderer.render(scene, camera);
        }

        // ==================== çª—å£èª¿æ•´ ====================
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // ==================== åˆå§‹åŒ– ====================
        window.addEventListener('load', init);
    </script>
</body>
</html>
